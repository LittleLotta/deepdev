@import "breakpoint";
@import "config";
@import "typography";

@include establish-baseline;
@font-face {
    font-family: 'leagueSpartanRegular';
    src: url('../fonts/leaguespartan-bold-webfont.eot');
    src: url('../fonts/leaguespartan-bold-webfont.eot?#iefix') format('embedded-opentype'),
         url('../fonts/leaguespartan-bold-webfont.woff2') format('woff2'),
         url('../fonts/leaguespartan-bold-webfont.woff') format('woff'),
         url('../fonts/leaguespartan-bold-webfont.ttf') format('truetype'),
         url('../fonts/leaguespartan-bold-webfont.svg#league_spartanregular') format('svg');
    font-weight: normal;
    font-style: normal;
}

$heightScreen:  100vh; // 100vh = height of screen = 200 meters of ocean

body, h1, h2, h3, p, ul {
  margin: 0; padding: 0;
}

.wrapper {
  overflow: hidden;
}

.addthis_sharing_toolbox {display: none;}
a {
  &:link { color: color(link) }
  &:visited { color: color(linkVisited) }
  &:hover, &:active, &:focus { color: color(linkHover) }
}

/* Animations */
%play-pause {
  animation-play-state: paused !important;
  .in-view & {
    animation-play-state: running !important;
  }
}

$howToHide: opacity duration(days) ease(Out);

%content-hidden {
  opacity: 0;
  transition: $howToHide;
}

%content-revealed {
  opacity: 1;
}

%sprited-thing {
  overflow: hidden;
  position: relative;
  // image that might animate
  &:before {
    content: " ";
    width: 100%;
    height: 100%; // non-animating default
    display: block;
  }
}

@import "title-card";

/* UI */
.progress {
  @extend %fontMerriweatherItalic;
  @extend %t-small;
  width: 2rem;
  position: fixed;
  right: .5rem; top: 50%;
  transform: translateY(-50%);
  z-index: 10;
  ul, li {
    list-style: none;
    margin: 0; padding: 0;
    text-indent: 0;
  }
  .visited {
    display: block;
    opacity: 1;
  }
  .completed {
    circle { fill: #fff; }
    path { fill: $twilight; }
  }
  svg {
    color: $abyss;
    display: block;
    max-height: 5vh;
    width: 2rem;
    position: relative;
    z-index: 2;
    circle {
      fill: color(link);
      transition: fill ease(In) duration(timely);
    }
    path {
      fill: currentColor
    }
  }
  a {
    display: block;
    paddng: .25rem;
  }
  li {
    &:not(:first-child) {
      background: url("../img/icons/progress-dots.svg") no-repeat top center;
      background-size: 5vh auto;
      padding-top: 5vh;
      span {
        top: calc(5vh - .6667em );
      }
    }
    display: none;
    opacity: 0;
    transition: opacity ease(Out) duration(fast);
    position: relative;
    span {
      background: rgba($twilight, .8);
      border-radius: .5rem;
      position: absolute;
      top: 0; left: -1rem;
      padding-right: .5rem;
      opacity: 0;
      transition:
        opacity ease(bounceInOut) duration(fast) duration(fast),
        transform ease(bounceInOut) duration(slow) duration(fast);
      width: 15rem;
      padding: rhythm(2);
      z-index: 1;
      &:after {
        left: 100%;
        top: 50%;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
        border-color: rgba(0, 0, 0, 0);
        border-left-color: rgba($twilight, .8);
        border-width: .5rem;
        margin-top: -.5rem;
      }
    }
    a:hover span {
      transform: translateX(-100%);
      opacity: 1;
    }
  }
}

#challenge_orange-roughy svg { color: $red; }

.segment {
  min-height: $heightScreen;
  padding: rhythm(12) rhythm(12) rhythm(12) rhythm(6);
  position: relative;
  @extend %clearfix;
  @include breakpoint($double_col){
    max-width: $maxSegmentWidth;
    margin: 0 auto;
  }
  @extend %t-medium;
  // everything starts paused and transparent...
  @extend %content-hidden;
  * {
    animation-play-state: paused;
  }
  // ...until you scroll them into view
  &.in-view {
    @extend %content-revealed;
    * {
      animation-play-state: running;
    }
  }
}

h3 + .content {
  padding-top: 0;
}

.challenge_wrapper > h3 {
  padding-top: rhythm(3);
}

.bonus {
  opacity: 0;
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  padding: rhythm(3) 0;
  .completed & {
    opacity: 1;
  }
}

.content, .challenge {
  @include breakpoint($medium){
    p {
      padding-bottom: 0;
      &:not(:first-of-type) {
        text-indent: 4em;
      }
    }
  }

  @include breakpoint($double_col){
    column-count: 2;
    column-gap: 2rem;
    ul, ol {
      page-break-inside: avoid;
      break-inside: avoid;
    }
  }
}

.video {
  display: block;
  margin: 0 auto;
  padding-top:rhythm(3);
  max-width: 100%;
  height: auto;
}

.challenge_wrapper {
  position:relative;
  z-index: 1;
}

.challenge {
  @extend %content-hidden;
  .in-view & {
    @extend %content-revealed;
  }
  // position: absolute;
  // top: 0; left: -1em; width: 100%;
  transition-property: opacity, background;
  // Appearance
  // background: $twilight;
  padding: rhythm(3) 1em;
  position: relative;
  margin: 0 -1em;
  .rediscover {
    position: absolute;
    top: rhythm(1); right: rhythm(1);
    @extend %t-small;
  }

  .completed & {
    pointer-events: none;
    // background: transparent;
    h3, p, ol, video {
      @extend %content-hidden;
    }
  }

  ol, li {
    margin: 0; padding: 0;
  }
  ol {
    @include padding-trailer(3);
  }
  li {
    @extend %fontSpartan;
    @include padding-leader();
    margin-left: rhythm(5);
    padding-left: rhythm();
  }
  li p {
    @extend %fontMerriweather;
    &:first-child {
      padding: 0;
    }
  }
}

.rediscover {
  @extend %fontMerriweatherItalic;
  color: color(link);
  cursor: pointer;
  text-decoration: underline;
}

.bonus {
  // unsolved/default
  // unsolved
  @extend %content-hidden;

  // solved/shown
  .solved & {
    @extend %content-revealed;
  }
}

h1, h2, h3 {
  @extend %fontSpartan;
}

h2 {
  @extend %t-xlarge;
  @include padding-trailer(6);
}

h3 {
  @extend %t-large;
}

.featured {
  @extend %fontSpartan;
}

em {
  @extend %fontMerriweatherItalic;
}

.red {
  @extend %fontMerriweatherItalic;
  color: $red;
}

.orange {
  @extend %fontMerriweatherItalic;
  color: #ff9100;
}

.biolumiColor {
  @extend %fontMerriweatherItalic;
  color: $biolumination;
}

strong {
  @extend %fontSpartan;
}

p {
  @extend %fontMerriweather;
  @include padding-trailer(3);
}

.callout {
  @extend %t-large;
  @extend %fontMerriweatherItalic;
  @include padding-leader();
  @include padding-trailer();
  text-align: center;
  transition-duration: duration(slowest);
}

.followup {
  @extend %t-medium;
  @extend %fontMerriweather;
  @include padding-leader();
  @include padding-trailer();
  text-align: center;
  transition-delay: duration(slow);
}

.standalone {
  max-width: 50em;
  margin: 0 auto;
  p {
    @extend %t-medium;
    @include padding-trailer(6);
  }
}

blockquote {
  &:first-child {
      padding: 0;
      margin: 0;
  }
  page-break-inside: avoid;
  break-inside: avoid;
  opacity: .7;
  @extend %t-large;
  @extend %fontMerriweatherItalic;
  @include padding-leader();
  @include padding-trailer();
}
cite {
  @extend %t-medium;
  @extend %fontMerriweatherItalic;
  font-style: normal;
  display: block;
  page-break-inside: avoid;
  break-inside: avoid;
  text-align: right;
  &:before {content: "\2014"; }
}

/* Footer */
footer {
  background: linear-gradient(to bottom, $greyLight 0%, darken($greyLight, 10%) 100%);
  color: $greyMedium;
  @include padding-trailer(15);
  text-align: center;
}

small {
  @extend %fontMerriweatherItalic;
  @extend %t-small;
}

.version {
  display: block;
  @extend %t-medium;
}

.wordmark {
  display: block;
  margin: 0 auto;
  height: rhythm(9);
  padding: rhythm(1)
}

/* Zones */
#epipelagic {
  background: linear-gradient(to bottom, $surface 0%, #007e84 50%, #0b4960 100%);
  color: color(altCopy);
}
#mesopelagic {
  background: linear-gradient(to bottom, #0b4960 0%, #0b4960 33%, #002351 67%, $abyss 100%);
  color: color(copy);
}
#bathypelagic {
  background: $abyss;
  // background: linear-gradient(to bottom, #0b4960 0%, #002351 100%);
  color: color(copy);
}
#abyssal {
  background: $abyss;
  // background: linear-gradient(to bottom, #002351 0%, $abyss 100%);
  color: color(copy);
}

/* Challenges */
@import "creature-shop";
@import "object-shop";
@import "flashlight-fish";
@import "nautilus";
@import "humboldt-squid";
@import "orange-roughy";
@import "disco";
@import "alarm-jellyfish";
@import "vomiting-shrimp";
@import "hagfish";

menu {
  background: $abyss;
  @extend %fontMerriweather;
  @extend %t-medium;
  color: color(copy);
  margin: 0;
  position: fixed;
  bottom: 0; left: 0;
  width: 100%;
  line-height: 2em;
  transition: background ease(In) duration(timely);
  z-index: 30;
  .bathypelagic &, .abyssal & {
    background: $epipelagic;
  }
}

#d1200 em {
  @extend %t-large;
  display: block;
  text-align: right;
}

#d3200 .callout {
  transition-delay: duration(days);
  transition-duration: duration(weeks);
}

@include breakpoint(calc-em(487)){
  .challenge, .content {
    li {
      @include padding-leader(2);
    }
  }
}

@include breakpoint(calc-em(638)){
  .challenge, .content {
    li {
      @include padding-leader(3);
    }
  }
}

.creature#creature_orange-roughy1 {
  filter: $blueFilter;
}