/* Props */
$creatures2x-use-percentages: true;
//$creatures2x-spacing: 4px;
$creatures2x-layout: smart;
@import "creatures2x/*.png";
$creatures2x-sprite-width: sprite_width($creatures2x-sprites);
$creatures2x-sprite-height: sprite_height($creatures2x-sprites);

$creatures-use-percentages: true;
//$creatures-spacing: 2px;
$creatures-layout: smart;
@import "creatures/*.png";
$creatures-sprite-width: sprite_width($creatures-sprites);

// Creature basics
.creature {
  @extend %sprited-thing;
  // SVG lights
  .lumi {
    position: absolute;
  }
}

// Make a creature
@mixin make-creature($imgName, $secondImgName: none, $lumiX: 0, $lumiY: 0, $lumiW: 0, $lumiH: 0, $keyframes: 2, $biolumi: false, $animation:false, $double: false) {
  $iWidth: image-width(sprite-file($creatures2x-sprites, #{$imgName}));
  width: $iWidth/2;

  &:before {
    @include creatures-sprite(#{$imgName});
    @include set-bg-width($creatures-sprite-width, $creatures-sprites, #{$imgName});
    @if $animation {
      height: $keyframes * 100%;
    } @else {
      height: 100%
    }
  }
  @if $double {
    &:after {
      @include creatures-sprite(#{$secondImgName});
      @include set-bg-width($creatures-sprite-width, $creatures-sprites, #{$secondImgName});
      content: " ";
      width: 100%;
      height: 100%;
      display: block;
      position: absolute;
      top: 0;
      left: 0;
    }
  }
  @if $animation {
    $iHeight: image-height(sprite-file($creatures2x-sprites, #{$imgName}))/$keyframes;
    height: $iHeight/2;
    @if $biolumi {
      .lumi {
        left: percentage(($lumiX + 4px)/$iWidth);
        top: percentage(($lumiY + 4px)/$iHeight);
        width: percentage(($lumiW * 1px)/$iWidth);
      }
    }
  } @else {
    $iHeight: image-height(sprite-file($creatures2x-sprites, #{$imgName}));
    height: $iHeight/2;
    @if $biolumi {
      .lumi {
        left: percentage(($lumiX + 4px)/$iWidth);
        top: percentage(($lumiY + 4px)/$iHeight);
        width: percentage(($lumiW * 1px)/$iWidth);
      }
    }
  }
}

@mixin set-bg-width($sprites-width, $sprite, $sprite-image) {
    $spriteX: percentage($sprites-width / image-width(sprite-file($sprite, $sprite-image)));
    background-size: $spriteX auto;
}

@media only screen and ( -webkit-min-device-pixel-ratio: 1.3 ),
       only screen and (    min--moz-device-pixel-ratio: 1.3 ),
       only screen and (      -o-min-device-pixel-ratio: 2.6/2 ),
       only screen and (         min-device-pixel-ratio: 1.3 ),
       only screen and ( min-resolution: 124.8dpi ),
       only screen and ( min-resolution: 1.3dppx ) {

      .creature {
        &:before, &:after {
          background-image: sprite-url($creatures2x-sprites);
        }
      }
}